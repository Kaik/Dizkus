{{ pageAddAsset('javascript', zasset('@ZikulaDizkusModule:js/chosen_v1.0.0/chosen.jquery.min.js')) }}
{{ pageAddAsset('stylesheet', zasset('@ZikulaDizkusModule:js/chosen_v1.0.0/chosen.css')) }}
{{ pageAddAsset('stylesheet', zasset('@ZikulaDizkusModule:css/chosen-bootstrap.css')) }}
{{ pageAddAsset('javascript', zasset('@ZikulaDizkusModule:js/Zikula.Dizkus.Admin.ModifyForum.js')) }}

{{ adminHeader() }}
{% form_theme form with ['bootstrap_3_layout.html.twig',
    'ZikulaFormExtensionBundle:Form:bootstrap_3_zikula_admin_layout.html.twig',
    'ZikulaDizkusModule:Form:radio.html.twig'
] %}

<h3>
    <span class="fa fa-pencil-square-o"></span>&nbsp;
    {% if forum.forum_id %}
        {{ __("Edit forum") }}&nbsp;{{ forum.name }}
    {% else %}
        {{ __("New forum") }}
    {% endif %}
</h3>
<div id="dizkus_admin">
    {{ showflashes() }}
    {{ form_start(form) }}
    {{ form_errors(form) }}
    <fieldset>

        <legend>{{ __("Forum settings")}}</legend>
        
        <div class="form-group">
            {{ form_label(form.name, __('Name') ,{ 'label_attr': {'class': 'col-md-3'} }) }} 
            <div class="col-lg-9">
                {{ form_widget(form.name, { 'attr': {'class': '', 'size': 70, 'maxlength':150 } }) }}                
            </div>
        </div>

        <div class="form-group">
            {{ form_label(form.description, __('Description') ,{ 'label_attr': {'class': 'col-md-3'} }) }}
            <div class="col-lg-9">
                {{ form_widget(form.description, { 'attr': {'class': '', 'size': 70, 'maxlength':150 } }) }}
            </div>
        </div>            

        <div class="form-group">       
            {{ form_label(form.status, __('Lock Forum') ,{ 'label_attr': {'class': 'col-md-3'} }) }}                  
            <div class="col-md-9">           
                {{ form_widget(form.status, {'attr': {'class': 'btn btn-primary radio-inline' }}) }}
                {{ form_errors(form.status) }}
                <p class="col-md-12 help-block alert alert-info pull-right">
                    {{ __("Locking a forum prevents new <strong>topics</strong> from being created in the forum.")}}
                </p>  
            </div>
        </div>             

        <div class="form-group">
            {{ form_label(form.parent, __('Parent') ,{ 'label_attr': {'class': 'col-md-3'} }) }} 
            <div class="col-lg-9">
                {{ form_widget(form.parent, { 'attr': {'class': ''} }) }}
            </div>
        </div>                

        {% if forum.forum_id %}
            <div class="form-group">
                <label for="forum_info" class="col-md-3 col-sm-3 control-label">{{ __('Forum Information') }}</label>           
                <div class="col-lg-9">
                    <span id="forum_info">
                        <a title="{{ __('Visit this forum') }}" href="{{ path('zikuladizkusmodule_user_viewforum', {'forum': forum.forum_id}) }}">
                            {{ topiccount }}&nbsp;{% if topiccount == 1 %}{{ __('Topic') }}{% else %}{{ __('Topics') }}{% endif %}&nbsp;/&nbsp;
                            {{ postcount }}&nbsp;{% if postcount == 1 %}{{ __('Post') }}{% else %}{{ __('Posts') }}{% endif %}
                        </a>
                    </span>
                </div>
            </div>
        {% endif %}            

        <div class="form-group">
            {{ form_label(form.moderatorUsers, __('Moderation (Users)'), { 'label_attr': {'class': 'col-md-3'} }) }}
            <div class="col-lg-9">
                {{ form_widget(form.moderatorUsers, { 'attr': {'class': 'chzn-select', 'data-placeholder': __('Select Some Options') } }) }}                
            </div>
        </div>

        <div class="form-group">
            {{ form_label(form.moderatorGroups, __('Moderation (Groups)'), { 'label_attr': {'class': 'col-md-3'} }) }}
            <div class="col-lg-9">
                {{ form_widget(form.moderatorGroups, { 'attr': {'class': 'chzn-select', 'data-placeholder': __('Select Some Options') } }) }} 
            </div>
        </div>        

    </fieldset>    

    <fieldset>
         <legend>{{ __("External sources")}}</legend>   
    
                <p class="col-md-12 help-block alert alert-warning ">
                    {{ __("External sources are not supported in this version of Dzikus.")}}
                </p>          
    
    </fieldset>     
            
    {{ notifyDisplayHooks(eventName='dizkus.ui_hooks.forum.ui_edit', id=forum.forum_id) }}
    
    <div class="form-group">
        <div class="col-lg-offset-6 col-md-8">
            {{ form_widget(form.save, {'attr': {'class': 'btn btn-success'}}) }}
            {{ form_widget(form.restore, {'attr': {'class': 'btn btn-danger'}}) }}
        </div>
    </div>   
    
    {{ form_end(form) }}
</div>    

{{ adminFooter() }}
{# 

    External sources (below) are disabled because is not implemented in this version

        <div id="extsource" class="form-group">
            <strong class="col-lg-3 control-label">{gt text="External source"}</strong>
            <div class="col-lg-9">
                <div class="radio">
                    {formlabel for="noexternal" __text='No external source'}
                    {formradiobutton id="noexternal" dataField="extsource"}
                </div>
                <div class="radio">
                    {formlabel for="mail2forum" __text='Mail2Forum'}
                    {formradiobutton id="mail2forum" dataField="extsource"}
                </div>
                <div class="radio">
                    {modavailable modname="Feeds" assign="feeds"}
                    {formlabel for="rss2forum" __text='RSS2Forum'}
                    {if $feeds}
                    {formradiobutton id="rss2forum" dataField='extsource'}
                    {else}
                    {formradiobutton id="rss2forum" dataField='extsource' disabled='disabled'}
                        &nbsp;<span class="text-danger">{gt text="'Feeds' module is not available."}</span>
                    {/if}
                </div>
            </div>
        </div>
    </fieldset>

    <fieldset id="logindata" {if (($extsource != 'mail2forum') && ($extsource != 'rss2forum'))}style="display:none;"{/if}>
        <legend>{gt text="Connect as User..."}</legend>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="coreUser" __text="Core user"}
            <div class="col-lg-9">
                {formdropdownlist id="coreUser" items=$allUsers cssClass='form-control'}
            </div>
        </div>
    </fieldset>

    <fieldset id="mail2forumField" {if $extsource != 'mail2forum'}style="display:none;"{/if}>
        <legend>{gt text="Mail2Forum"}</legend>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="pop3_test" __text="Perform POP3 test after saving"}
            <div class="col-lg-9">
                <div class="checkbox">
                    {formcheckbox id="pop3_test"}
                </div>
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="server" __text="POP3 server"}
            <div class="col-lg-9">
                {formtextinput id="server" maxLength="60" size="30" cssClass='form-control'}
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="port" __text="POP3 port"}
            <div class="col-lg-9">
                {formtextinput id="port" maxLength="5" size="5" cssClass='form-control'}
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="login" __text="POP3 log-in name"}
            <div class="col-lg-9">
                {formtextinput id="login" maxLength="60" size="30" cssClass='form-control'}
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="password" __text="POP3 password"}
            <div class="col-lg-9">
                {formtextinput textMode="password" id="password" maxLength="60" size="30" cssClass='form-control'}
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="passwordconfirm" __text="POP3 password (repeat for verification)"}
            <div class="col-lg-9">
                {formtextinput textMode="password" id="passwordconfirm" maxLength="60" size="30" cssClass='form-control'}
            </div>
        </div>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="matchstring" __text="Rule"}
            <div class="col-lg-9">
                {formtextinput id="matchstring" maxLength="255" size="30" cssClass='form-control'}
                <em class="help-block">
                    {gt text="Notice: This rule is a regular expression applied to posts incoming via e-mail, in order to prevent spam postings. If there is no rule here then no checks will be performed."}
                </em>
            </div>
        </div>
    </fieldset>

    {if $feeds}
    <fieldset id="rss2forumField" {if $extsource != 'rss2forum'}style="display:none;"{/if}>
        <legend>{gt text="RSS2Forum"}</legend>
        <div class="form-group">
            {formlabel class="col-lg-3 control-label" for="rssfeed" __text="Select RSS feed"}
            <div class="col-lg-9">
                <select name="rssfeed" size="1" class="form-control">
                    <option value="0">{gt text="None"}</option>
                    {if $rssfeeds}
                        {foreach item='feed' from=$rssfeeds}
                            <option value="{$feed.fid}" {if $feed.fid == $externalsourceurl}selected="selected"{/if}>{$feed.name|safetext} ({$feed.url})</option>
                        {/foreach}
                    {/if}
                </select>
            </div>
        </div>
    </fieldset>
    {/if}

    {notifydisplayhooks eventname='dizkus.ui_hooks.forum.ui_edit' id=$forum_id}

#}
